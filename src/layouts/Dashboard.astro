---
import "@fontsource/nixie-one";
import { ClientRouter } from "astro:transitions";
import "@ant-design/v5-patch-for-react-19";
import Aside from "../components/Aside";
import ProfilePopover from "@components/ProfilePopover.astro";
import { getSession } from "auth-astro/server";
import { Icon } from "astro-icon/components";

const { pageTitle } = Astro.props;
const session = await getSession(Astro.request);
const user = session?.user;

const currentPath = Astro.url.pathname;
---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <meta name="generator" content={Astro.generator} />
    <meta name="author" content="Rafael Meza" />
    <meta
      name="keywords"
      content="Okay, aquí tienes la lista de palabras clave SEO separadas por comas, basándome en las descripciones mejoradas para tu app inmobiliaria y considerando el contexto de búsqueda en español (incluyendo potencial para Lima, Perú):

app inmobiliaria, aplicación inmobiliaria, inmobiliaria online, plataforma inmobiliaria, buscar inmuebles, encontrar propiedades, buscar casas, buscar apartamentos, buscar departamentos, buscar propiedades en venta, buscar propiedades en alquiler, búsqueda de inmuebles, encontrar mi hogar, inmuebles en venta, inmuebles en alquiler, propiedades en venta, propiedades en alquiler, casas en venta, casas en alquiler, apartamentos en venta, apartamentos en alquiler, departamentos en venta, departamentos en alquiler, venta de inmuebles, alquiler de inmuebles, venta de casas, alquiler de apartamentos, alquiler de departamentos, filtros de búsqueda inmuebles, mapas de propiedades, fotos de inmuebles, alertas de propiedades, notificaciones de inmuebles, inmuebles favoritos, guardar favoritos, contactar anunciantes, chat inmobiliario, búsqueda por mapa, búsqueda por precio, búsqueda por ubicación, búsqueda por tipo de propiedad, inmuebles en Lima, propiedades en Lima, casas en Lima, apartamentos en Lima, departamentos en Lima, venta casas Lima, alquiler apartamentos Lima, inmobiliaria en Lima, buscar propiedades en Lima, inmuebles en Miraflores, propiedades en San Isidro, apartamentos en Surco, casas en Barranco, inmobiliaria [Nombre de tu app] Lima, app para buscar casas en venta, aplicación para encontrar apartamentos en alquiler, cómo buscar inmuebles online, mejores apps para encontrar propiedades, inmuebles en venta con fotos y mapa"
    />
    <meta
      name="description"
      content="La app inmobiliaria más fail de usar para encontrar propiedades a tu medida. Busca inmuebles (incluyendo casas y departamentos) en venta y alquiler con herramientas de búsqueda optimizadas para tu facil uso. Visualiza cada propiedad con galerías de fotos y detalles clave. Guarda tus inmuebles favoritos y recibe notificaciones personalizadas. Simplifica tu proceso de buscar propiedades y encuentra tu espacio ideal."
    />
    <meta name="robots" content="index, follow " />
    <link rel="canonical" href="https://www.rafaelmeza.com/" />
    <meta property="og:title" content="Rafael Meza" />
    <meta
      property="og:description"
      content="La app inmobiliaria más fail de usar para encontrar propiedades a tu medida. Busca inmuebles (incluyendo casas y departamentos) en venta y alquiler con herramientas de búsqueda optimizadas para tu facil uso. Visualiza cada propiedad con galerías de fotos y detalles clave. Guarda tus inmuebles favoritos y recibe notificaciones personalizadas. Simplifica tu proceso de buscar propiedades y encuentra tu espacio ideal."
    />
    <meta property="og:image" content="https://www.rafaelmeza.com/rafael.png" />
    <title>
      {pageTitle}
      {pageTitle ? " | " : ""}
      Home | Inmobiliaria
    </title>
    <ClientRouter />
  </head>
  <body id="dashboard">
    <header class="border-b py-3 flex justify-between relative z-20">
      <div class="max-w-[1360px] px-4 mx-auto w-full flex justify-between items-center">
        <h1 class="block">
          <a href="/" title="Inicio | Inmobiliaria" class="flex items-center gap-2 text-sm font-semibold uppercase">
            <span class="p-2 rounded-xl bg-cyan-500 block">
              <Icon name="solar:home-smile-bold" class="text-3xl text-white" />
            </span>
            <span>Home</span>
          </a>
        </h1>
        <ProfilePopover />
      </div>
    </header>
    <main class="flex items-start max-w-[1360px] mx-auto w-full z-10 min-h-lvh relative">
      {
        user && user?.name && user?.image ? (
          <Aside
            client:load
            currentPath={currentPath}
            userName={user.name}
            userImage={user.image}
          />
        ) : null
      }
      <section
        class="flex-grow relative px-4 pt-12 pb-4 lg:border-l min-h-lvh lg:border-gray-200"
      >
        <slot />
      </section>
    </main>
  </body>
</html>
